<UserControl x:Class="DesktopHub.UI.Widgets.QuickTasksWidget"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="340">
    
    <UserControl.Resources>
        <!-- Priority dot colors -->
        <SolidColorBrush x:Key="HighPriorityBrush" Color="#FF5252"/>
        <SolidColorBrush x:Key="NormalPriorityBrush" Color="#B0BEC5"/>
        <SolidColorBrush x:Key="LowPriorityBrush" Color="#546E7A"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#4FC3F7"/>
        <SolidColorBrush x:Key="TextBrush" Color="#F5F7FA"/>
        <SolidColorBrush x:Key="DimTextBrush" Color="#90A4AE"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#10F5F7FA"/>
        <SolidColorBrush x:Key="HoverBrush" Color="#20F5F7FA"/>
    </UserControl.Resources>
    
    <Grid>
        <StackPanel>
            <!-- Header: Title + Date -->
            <Grid Margin="0,0,0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0"
                          Text="Quick Tasks"
                          FontSize="14"
                          FontWeight="SemiBold"
                          Foreground="{StaticResource TextBrush}"/>
                
                <TextBlock x:Name="DateLabel"
                          Grid.Column="1"
                          Text="Feb 9, 2026"
                          FontSize="11"
                          Foreground="{StaticResource DimTextBrush}"
                          VerticalAlignment="Center"
                          Cursor="Hand"
                          MouseLeftButtonDown="DateLabel_Click"
                          ToolTip="Click to pick a date">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </Grid>
            
            <!-- Date Navigation + Add Button -->
            <Grid Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Previous Day -->
                <Border Grid.Column="0"
                        x:Name="PrevDayButton"
                        Background="Transparent"
                        CornerRadius="4"
                        Padding="6,3"
                        Cursor="Hand"
                        MouseLeftButtonDown="PrevDayButton_Click">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock Text="&lt;" FontSize="12" FontWeight="Bold" Foreground="{StaticResource DimTextBrush}" VerticalAlignment="Center"/>
                </Border>
                
                <!-- Today Button -->
                <Border Grid.Column="1"
                        x:Name="TodayButton"
                        Background="Transparent"
                        CornerRadius="4"
                        Padding="8,3"
                        Margin="4,0"
                        Cursor="Hand"
                        MouseLeftButtonDown="TodayButton_Click">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock x:Name="TodayButtonText" Text="Today" FontSize="10" Foreground="{StaticResource AccentBrush}" VerticalAlignment="Center"/>
                </Border>
                
                <!-- Next Day -->
                <Border Grid.Column="2"
                        x:Name="NextDayButton"
                        Background="Transparent"
                        CornerRadius="4"
                        Padding="6,3"
                        Cursor="Hand"
                        MouseLeftButtonDown="NextDayButton_Click">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock Text="&gt;" FontSize="12" FontWeight="Bold" Foreground="{StaticResource DimTextBrush}" VerticalAlignment="Center"/>
                </Border>
                
                <!-- Spacer -->
                <Border Grid.Column="3"/>
                
                <!-- Add Task Button -->
                <Border Grid.Column="4"
                        x:Name="AddTaskButton"
                        Background="{StaticResource SurfaceBrush}"
                        BorderBrush="#30F5F7FA"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="10,4"
                        Cursor="Hand"
                        MouseLeftButtonDown="AddTaskButton_Click">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock Text="+ Add Task" FontSize="11" Foreground="{StaticResource AccentBrush}"/>
                </Border>
            </Grid>
            
            <!-- New Task Input (hidden by default) -->
            <Border x:Name="NewTaskPanel"
                    Visibility="Collapsed"
                    Background="{StaticResource SurfaceBrush}"
                    CornerRadius="6"
                    Padding="10,8"
                    Margin="0,0,0,8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBox x:Name="NewTaskInput"
                            Grid.Column="0"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextBrush}"
                            CaretBrush="{StaticResource TextBrush}"
                            FontSize="12"
                            VerticalAlignment="Center"
                            KeyDown="NewTaskInput_KeyDown"
                            LostFocus="NewTaskInput_LostFocus">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="TextBox">
                                            <Grid>
                                                <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center"/>
                                                <TextBlock x:Name="Placeholder"
                                                          Text="Type a task and press Enter..."
                                                          Foreground="#60F5F7FA"
                                                          FontSize="12"
                                                          VerticalAlignment="Center"
                                                          IsHitTestVisible="False"
                                                          Visibility="Collapsed"/>
                                            </Grid>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="Text" Value="">
                                                    <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TextBox.Style>
                    </TextBox>
                    
                    <TextBlock Grid.Column="1"
                              Text="ESC to cancel"
                              FontSize="9"
                              Foreground="#40F5F7FA"
                              VerticalAlignment="Center"
                              Margin="8,0,0,0"/>
                </Grid>
            </Border>
            
            <!-- Task List -->
            <ScrollViewer x:Name="TaskScrollViewer"
                         MaxHeight="220"
                         VerticalScrollBarVisibility="Auto">
                <ScrollViewer.Resources>
                    <Style TargetType="ScrollBar">
                        <Setter Property="Width" Value="4"/>
                    </Style>
                </ScrollViewer.Resources>
                <StackPanel x:Name="TaskListPanel"/>
            </ScrollViewer>
            
            <!-- Empty State -->
            <Border x:Name="EmptyState"
                    Visibility="Collapsed"
                    Padding="0,20">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="No tasks for this day"
                              FontSize="12"
                              Foreground="#40F5F7FA"
                              HorizontalAlignment="Center"/>
                    <TextBlock Text="Click '+ Add Task' to get started"
                              FontSize="10"
                              Foreground="#30F5F7FA"
                              HorizontalAlignment="Center"
                              Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
            
            <!-- Footer: Counts + Search -->
            <Border Margin="0,10,0,0"
                    BorderBrush="#15F5F7FA"
                    BorderThickness="0,1,0,0"
                    Padding="0,8,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock x:Name="StatusText"
                              Grid.Column="0"
                              Text="0 active"
                              FontSize="10"
                              Foreground="#50F5F7FA"
                              VerticalAlignment="Center"/>
                    
                    <!-- Search Toggle -->
                    <Border Grid.Column="1"
                            x:Name="SearchToggleButton"
                            Background="Transparent"
                            CornerRadius="4"
                            Padding="6,3"
                            Cursor="Hand"
                            MouseLeftButtonDown="SearchToggle_Click">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <TextBlock Text="&#128269;" FontSize="11" VerticalAlignment="Center"/>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Search Panel (hidden by default) -->
            <Border x:Name="SearchPanel"
                    Visibility="Collapsed"
                    Background="{StaticResource SurfaceBrush}"
                    CornerRadius="6"
                    Padding="10,8"
                    Margin="0,6,0,0">
                <TextBox x:Name="SearchInput"
                        Background="Transparent"
                        BorderThickness="0"
                        Foreground="{StaticResource TextBrush}"
                        CaretBrush="{StaticResource TextBrush}"
                        FontSize="11"
                        TextChanged="SearchInput_TextChanged"
                        KeyDown="SearchInput_KeyDown">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Grid>
                                            <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center"/>
                                            <TextBlock x:Name="Placeholder"
                                                      Text="Search all tasks..."
                                                      Foreground="#60F5F7FA"
                                                      FontSize="11"
                                                      VerticalAlignment="Center"
                                                      IsHitTestVisible="False"
                                                      Visibility="Collapsed"/>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                </TextBox>
            </Border>
            
            <!-- Search Results (hidden by default) -->
            <ScrollViewer x:Name="SearchResultsScroller"
                         Visibility="Collapsed"
                         MaxHeight="200"
                         Margin="0,4,0,0"
                         VerticalScrollBarVisibility="Auto">
                <StackPanel x:Name="SearchResultsPanel"/>
            </ScrollViewer>
        </StackPanel>
    </Grid>
</UserControl>
